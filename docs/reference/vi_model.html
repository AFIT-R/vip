<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Model-Based Variable Importance — vi_model • vip</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Model-Based Variable Importance — vi_model" />

<meta property="og:description" content="Compute model-based variable importance scores for the predictors in a model.
(This function is meant for internal use only.)" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vip</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vip.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vip-interaction.html">Quantifying the Strength of Potential Interaction Effects</a>
    </li>
    <li>
      <a href="../articles/vip-tensorflow.html">Using vip with Unsupported Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/koalaverse/vip">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Model-Based Variable Importance</h1>
    <small class="dont-index">Source: <a href='https://github.com/koalaverse/vip/blob/master/R/vi_model.R'><code>R/vi_model.R</code></a></small>
    <div class="hidden name"><code>vi_model.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Compute model-based variable importance scores for the predictors in a model.
(This function is meant for internal use only.)</p>
    
    </div>

    <pre class="usage"><span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for C5.0</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for constparty</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for earth</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for gbm</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for H2OBinomialModel</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for H2OMultinomialModel</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for H2ORegressionModel</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for lm</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ml_model_decision_tree_regression</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ml_model_decision_tree_classification</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ml_model_gbt_regression</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ml_model_gbt_classification</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ml_model_generalized_linear_regression</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ml_model_linear_regression</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ml_model_random_forest_regression</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ml_model_random_forest_classification</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for randomForest</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for RandomForest</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='kw'>auc</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for ranger</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for rpart</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for train</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for xgb.Booster</span>
<span class='fu'>vi_model</span>(<span class='no'>object</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A fitted model object (e.g., a <code>"randomForest"</code> object).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional optional arguments.</p></td>
    </tr>
    <tr>
      <th>auc</th>
      <td><p>Logical indicating whether or not to compute the AUC-based
variable scores described in Janitza et al. (2012). Only available for
<code><a href='https://www.rdocumentation.org/packages/party/topics/cforest'>cforest</a></code> objects. See
<code><a href='https://www.rdocumentation.org/packages/party/topics/varimp'>varimpAUC</a></code> for details. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>For xgboost models, the type of variable importance to return.
If <code>NULL</code> (the default), "Gain" is used. See
<code><a href='https://www.rdocumentation.org/packages/xgboost/topics/xgb.importance'>xgb.importance</a></code> for details.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tidy data frame (i.e., a <code>"tibble"</code> object) with two columns:
<code>Variable</code> and <code>Importance</code>. For <code>"lm"/"glm"</code>-like object, an
additional column, called <code>Sign</code>, is also included which includes the
sign (i.e., POS/NEG) of the original coefficient.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Computes model-based variable importance scores depending on the class of
<code>object</code>:</p>
<dl class='dl-horizontal'>
    <dt><code><a href='https://www.rdocumentation.org/packages/C50/topics/C5.0'>C5.0</a></code></dt><dd><p>Variable importance is measured by determining
the percentage of training set samples that fall into all the terminal nodes
after the split. For example, the predictor in the first split automatically
has an importance measurement of 100 percent since all samples are affected
by this split. Other predictors may be used frequently in splits, but if the
terminal nodes cover only a handful of training set samples, the importance
scores may be close to zero. The same strategy is applied to rule-based
models and boosted versions of the model. The underlying function can also
return the number of times each predictor was involved in a split by using
the option <code>metric = "usage"</code>. See <code><a href='https://www.rdocumentation.org/packages/C50/topics/C5imp'>C5imp</a></code> for
details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/partykit/topics/cforest'>cforest</a></code></dt><dd><p>Variable importance is measured in a
way similar to those computed by <code><a href='https://www.rdocumentation.org/packages/randomForest/topics/importance'>importance</a></code>.
Besides the standard version, a conditional version is available that
adjusts for correlations between predictor variables. If
<code>conditional = TRUE</code>, the importance of each variable is computed by
permuting within a grid defined by the predictors that are associated (with
1 - <em>p</em>-value greater than threshold) to the variable of interest. The
resulting variable importance score is conditional in the sense of beta
coefficients in regression models, but represents the effect of a variable in
both main effects and interactions. See Strobl et al. (2008) for details.
Note, however, that all random forest results are subject to random
variation. Thus, before interpreting the importance ranking, check whether
the same ranking is achieved with a different random seed - or otherwise
increase the number of trees ntree in <code><a href='https://www.rdocumentation.org/packages/partykit/topics/ctree_control'>ctree_control</a></code>.
Note that in the presence of missings in the predictor variables the
procedure described in Hapfelmeier et al. (2012) is performed. See
<code><a href='https://www.rdocumentation.org/packages/partykit/topics/varimp'>varimp</a></code> for details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/earth/topics/earth'>earth</a></code></dt><dd><p>The variable importance method for
<code><a href='https://www.rdocumentation.org/packages/earth/topics/earth'>earth</a></code> objects first calculates the decrease in the GCV for each
subset relative to the previous subset during earth’s pruning pass. (For
multiple response models, GCV's are calculated over all responses.) Then, for
each variable, it sums these decreases over all subsets that include the
variable. Finally, for ease of interpretation, the summed decreases are
scaled so the largest summed decrease is 100. Variables which cause larger
net decreases in the GCV are considered more important. See
<code><a href='https://www.rdocumentation.org/packages/earth/topics/evimp'>evimp</a></code> for details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/gbm/topics/gbm'>gbm</a></code></dt><dd><p>Variable importance is computed according to
Friedman (2001). For tree-based methods, the approximate relative influence
of a variable \(x_j\) is $$\widehat{J}_j^2 = \sum{\text{splits on } x_j}I_t^2$$
where \(I_t\) is the empirical improvement by splitting on \(x_j\) at that point.
Friedman's extension to boosted models is to average the relative influence
of variable \(x_j\) across all the trees generated by the boosting algorithm.
See <code><a href='https://www.rdocumentation.org/packages/gbm/topics/summary.gbm'>summary.gbm</a></code> for details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/h2o/topics/H2OModel-class'>H2OModel</a></code></dt><dd><p>See <code><a href='https://www.rdocumentation.org/packages/h2o/topics/h2o.varimp'>h2o.varimp</a></code> or visit
<a href='http://docs.h2o.ai/h2o/latest-stable/h2o-docs/variable-importance.html'>http://docs.h2o.ai/h2o/latest-stable/h2o-docs/variable-importance.html</a>
for details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm</a></code></dt><dd><p>In (generalized) linear models, variable
importance is based on the absolute value of the corresponding
<em>t</em>-statistics. For such models, the sign of the original coefficient
is also returned.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/sparklyr/topics/ml_feature_importances'>ml_feature_importances</a></code></dt><dd><p>The Spark ML
library provides standard variable importance for tree-based methods (e.g.,
random forests). See <code><a href='https://www.rdocumentation.org/packages/sparklyr/topics/ml_feature_importances'>ml_feature_importances</a></code> for
details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/randomForest/topics/randomForest'>randomForest</a></code></dt><dd><p>Random forests typically
provide two measures of variable importance. The first measure is computed
from permuting out-of-bag (OOB) data: for each tree, the prediction error on
the OOB portion of the data is recorded (error rate for classification and
MSE for regression). Then the same is done after permuting each predictor
variable. The difference between the two are then averaged over all trees in
the forest, and normalized by the standard deviation of the differences. If
the standard deviation of the differences is equal to 0 for a variable,
the division is not done (but the average is almost always equal to 0 in that
case).
    The second measure is the total decrease in node impurities from splitting on
the variable, averaged over all trees. For classification, the node impurity
is measured by the Gini index. For regression, it is measured by residual sum
of squares. See <code><a href='https://www.rdocumentation.org/packages/randomForest/topics/importance'>importance</a></code> for details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/party/topics/cforest'>cforest</a></code></dt><dd><p>Same approach described in
<code><a href='https://www.rdocumentation.org/packages/partykit/topics/cforest'>cforest</a></code> above. See <code><a href='https://www.rdocumentation.org/packages/party/topics/varimp'>varimp</a></code> and
<code><a href='https://www.rdocumentation.org/packages/party/topics/varimp'>varimpAUC</a></code> (if <code>auc = TRUE</code>) for details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/ranger/topics/ranger'>ranger</a></code></dt><dd><p>Variable importance for
<code><a href='https://www.rdocumentation.org/packages/ranger/topics/ranger'>ranger</a></code> objects is computed in the usual way for random
forests. The approach used depends on the <code>importance</code> argument provided
in the initial call to <code><a href='https://www.rdocumentation.org/packages/ranger/topics/ranger'>ranger</a></code>. See
<code><a href='https://www.rdocumentation.org/packages/ranger/topics/importance.ranger'>importance</a></code> for details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/rpart/topics/rpart'>rpart</a></code></dt><dd><p>As stated in one of the <strong>rpart</strong>
vignettes. A variable may appear in the tree many times, either as a primary
or a surrogate variable. An overall measure of variable importance is the sum
of the goodness of split measures for each split for which it was the primary
variable, plus "goodness" * (adjusted agreement) for all splits in which it
was a surrogate. Imagine two variables which were essentially duplicates of
each other; if we did not count surrogates, they would split the importance
with neither showing up as strongly as it should. See
<code><a href='https://www.rdocumentation.org/packages/rpart/topics/rpart'>rpart</a></code> for details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/caret/topics/train'>train</a></code></dt><dd><p>Various model-specific and model-agnostic
approaches that depend on the learning algorithm employed in the original
call to <code><a href='https://www.rdocumentation.org/packages/caret/topics/train'>train</a></code>. See <code><a href='https://www.rdocumentation.org/packages/caret/topics/varImp'>varImp</a></code> for
details.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/xgboost/topics/xgb.train'>xgboost</a></code></dt><dd><p>For linear models, the variable
importance is the absolute magnitude of the estimated coefficients. For that
reason, in order to obtain a meaningful ranking by importance for a linear
model, the features need to be on the same scale (which you also would want
to do when using either L1 or L2 regularization). Otherwise, the approach
described in Friedman (2001) for <code><a href='https://www.rdocumentation.org/packages/gbm/topics/gbm'>gbm</a></code>s is used. See
<code><a href='https://www.rdocumentation.org/packages/xgboost/topics/xgb.importance'>xgb.importance</a></code> for details.</p></dd>
    </dl>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Inspired by the <code><a href='https://www.rdocumentation.org/packages/caret/topics/varImp'>varImp</a></code> function.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Brandon Greenwell, Brad Boehmke, Bernie Gray.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

